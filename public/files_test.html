<html>

<head>
    <title>Files Support test</title>
    <link rel="stylesheet" href="/style.css">
    <script src="/js/jquery.js"></script>
</head>

<body>
    <h1>Files Support Test</h1>
    <h4>1. Send file/files</h4>
    <form action="/api/v1/files" method="POST" enctype="multipart/form-data">
        <input type="file" name="files" multiple>
        <button type="submit">Send file/files</button>
    </form>
    <h4>2. List of files</h4>
    <ul class="files">
    </ul>
    <h4>2. Change name</h4>
    <label><select class="files" name="file"></select> to <input type="text" class="new_name" name="new_name "placeholder="New name"><button type="button" class="new_name">Change!</button></label>
</body>
<script>
get_files();


$("button.new_name").click(function(){
	var selected_file = $('select.files').val();
	var new_name = $('input.new_name').val();
	console.log(selected_file, new_name);
	$.ajax({
	    url: '/api/v1/files/'+selected_file,
	    type: 'PUT',
	    data: {
	    	new_name: new_name
	    },
	    success: function(result) {
	        get_files();
	    }
	});
});
function get_files() {
    var files_list = $('ul.files');
    var files_select = $('select.files');
    $(files_list).empty();
    $(files_select).empty();
    $.get('/api/v1/files', function(data) {
        for (var i in data) {
            files_list.append("<li data_id='" + data[i].sealious_name + "'>" + data[i].original_name + "." + data[i].extension + "</li>");
            files_select.append("<option value='" + data[i].sealious_name + "'>" + data[i].original_name + "</option>");
        }
    });
}
</script>

</html>
